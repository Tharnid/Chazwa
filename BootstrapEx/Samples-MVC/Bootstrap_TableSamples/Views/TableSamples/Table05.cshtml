@model SamplesData.ProductViewModel5

@{
  ViewBag.Title = "Table Sample 5 - Paging & Sorting using C#";
}

<style>
  .pagination {
    margin-top: -1em;
  }
</style>

@using (Html.BeginForm())
{
  <!-- BEGIN HIDDEN FIELDS AREA -->
  @Html.HiddenFor(m => m.EventCommand)
  @Html.HiddenFor(m => m.EventArgument)
  @Html.HiddenFor(m => m.Pager.PageIndex)
  @Html.HiddenFor(m => m.LastSortExpression)
  @Html.HiddenFor(m => m.SortExpression)
  @Html.HiddenFor(m => m.SortDirection)
  @Html.HiddenFor(m => m.SortDirectionNew)
  <!-- END HIDDEN FIELDS AREA -->

  <div class="row">
    <div class="col-md-12">
      <div class="table-responsive">
        <table class="table table-condensed table-bordered table-striped table-hover">
          <thead>
            <tr>
              <th>
                <a href="#"
                   data-pdsa-action="sort"
                   data-pdsa-val="ProductName"
                   data-pdsa-direction="Ascending">
                  Product Name
                </a>
              </th>
              <th>
                <a href="#"
                   data-pdsa-action="sort"
                   data-pdsa-val="IntroductionDate"
                   data-pdsa-direction="Ascending">
                  Introduction Date
                </a>
              </th>
              <th>
                <a href="#"
                   data-pdsa-action="sort"
                   data-pdsa-val="Cost"
                   data-pdsa-direction="Descending">
                  Cost
                </a>
              </th>
              <th>
                <a href="#"
                   data-pdsa-action="sort"
                   data-pdsa-val="Price"
                   data-pdsa-direction="Ascending">
                  Price
                </a>
              </th>
            </tr>
          </thead>
          <tbody>
            @foreach (var item in Model.Products)
            {
              <tr>
                <td>
                  @item.ProductName
                </td>
                <td>
                  @item.IntroductionDate.ToShortDateString()
                </td>
                <td>
                  @item.Cost.ToString("c")
                </td>
                <td>
                  @item.Price.ToString("c")
                </td>
              </tr>
            }
          </tbody>
        </table>
      </div>
      @if (Model.IsPagerVisible)
      {
        <ul class="pagination pagination-sm">
          @foreach (SamplesData.PDSAPagerItem item in Model.Pages)
          {
            <li class="@item.CssClass">
              <a href="#"
                 data-pdsa-action="page"
                 data-pdsa-val="@item.Argument"
                 title="@item.Tooltip">
                @Html.Raw(item.Text)
              </a>
            </li>
          }
        </ul>
      }
    </div>
  </div>
}

@section scripts {
  <script>
    $(document).ready(function () {
      // Connect to any elements that have 'data-pdsa-action'
      $("[data-pdsa-action]").on("click", function (e) {
        e.preventDefault();

        // Fill in hidden fields with action and argument to post back to model
        $("#EventCommand").val($(this).attr("data-pdsa-action"));
        $("#EventArgument").val($(this).attr("data-pdsa-val"));

        // Use the switch statement to get and set any special parameters
        switch ($("#EventCommand").val()) {
          case "sort":
            // Store the last sort expression
            $("#LastSortExpression").val($("#SortExpression").val());
            // Get the new sort expression
            $("#SortExpression").val($(this).data("pdsa-val"));
            // Set the new sort direction
            $("#SortDirectionNew").val($(this).data("pdsa-direction"));
            break;
        }

        // Submit form with hidden values filled in
        $("form").submit();
      });
    });
  </script>
}